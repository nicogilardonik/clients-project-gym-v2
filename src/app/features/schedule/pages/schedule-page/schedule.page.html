<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Horarios</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="container">
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <app-day-selector
          [enrollmentsByDay]="enrollmentsByDay"
          (daySelected)="onDaySelected($event)"
        ></app-day-selector>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="12">
        <h2 class="schedule-title">Horarios Disponibles</h2>
        <!-- Loading spinner -->
        <div *ngIf="loading" class="loading-container">
          <ion-spinner name="circular"></ion-spinner>
          <p>Cargando horarios...</p>
        </div>
        <!-- Schedule cards -->
        <div *ngIf="!loading" class="schedule-list">
          <app-schedule-card
            *ngFor="let schedule of schedulesForDay"
            [schedule]="schedule"
            [currentUserId]="currentUserId"
            (scheduleClicked)="onScheduleClicked($event)"
          ></app-schedule-card>
          <!-- Empty state -->
          <div *ngIf="schedulesForDay.length === 0" class="empty-state">
            <p>No hay horarios disponibles para este día.</p>
          </div>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Modal de inscripción -->
  <ion-modal [isOpen]="showEnrollModal">
    <ng-template>
      <app-enroll-confirmation-modal
        [schedule]="selectedSchedule"
        (confirm)="onEnrollConfirmed()"
        (cancel)="onEnrollModalDismiss()"
      ></app-enroll-confirmation-modal>
    </ng-template>
  </ion-modal>

  <!-- Modal de desinscripción -->
  <ion-modal [isOpen]="showUnsubscribeModal">
    <ng-template>
      <app-unsubscribe-confirmation-modal
        [schedule]="selectedSchedule"
        (confirm)="onUnsubscribeConfirmed()"
        (cancel)="onUnsubscribeModalDismiss()"
      ></app-unsubscribe-confirmation-modal>
    </ng-template>
  </ion-modal>

  <!-- Alert para límite de inscripciones o errores -->
  <ion-alert
    [isOpen]="showAlert"
    (ionAlertDidDismiss)="onAlertDismiss()"
    header="Información"
    message="{{ alertMessage }}"
    buttons="OK"
  >
  </ion-alert>
</ion-content>
